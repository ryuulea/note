Option Explicit

Public Sub CheckMailBody900_SimpleJP()
    Const HEADER As String = "メール本文" ' チェック対象の列見出し
    Const START_ROW As Long = 3           ' 3行目からチェック開始
    Const MAX_LEN As Long = 900           ' 最大文字数

    Dim ws As Worksheet: Set ws = ActiveSheet
    Dim lastCol As Long, lastRow As Long, col As Long
    Dim found As Boolean

    ' 1行目から「メール本文」列を探す
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    For col = 1 To lastCol
        If Trim(CStr(ws.Cells(1, col).Value)) = HEADER Then
            found = True
            Exit For
        End If
    Next col

    If Not found Then
        MsgBox "列見出し「" & HEADER & "」が見つかりません。", vbExclamation
        Exit Sub
    End If

    ' 最終行を取得
    lastRow = ws.Cells(ws.Rows.Count, col).End(xlUp).Row

    ' チェック開始
    Dim r As Long, txt As String, L As Long, errCount As Long
    For r = START_ROW To lastRow
        txt = CStr(ws.Cells(r, col).Value)
        L = Len(txt)
        If L > MAX_LEN Then
            errCount = errCount + 1
        End If
    Next r

    ' 結果表示
    If errCount = 0 Then
        MsgBox "チェック完了：" & HEADER & "列（" & START_ROW & "行目以降）は全て900文字以内です。", vbInformation
    Else
        MsgBox "エラー：" & errCount & " 行が900文字を超えています。", vbExclamation
    End If
End Sub
