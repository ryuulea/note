Public Sub CheckAll()
    Dim ws As Worksheet: Set ws = ActiveSheet
    Dim headerRow As Long
    Dim genreResult As String, subjectResult As String, bodyResult As String
    Dim wsOut As Worksheet
    Dim lines() As String, i As Long
    Dim msg As String
    
    headerRow = GetHeaderRow(ws)
    If headerRow = -1 Then
        MsgBox "表頭に「メール本文」が見つかりません。", vbExclamation
        Exit Sub
    End If
    
    ' === 各チェック結果 ===
    genreResult = CheckTemplateGenre_Result(ws, headerRow)
    subjectResult = CheckMailSubject_Result(ws, headerRow)
    bodyResult = CheckMailBody_Result(ws, headerRow)
    
    ' === 出力先シート ===
    Set wsOut = Worksheets("チェック結果")
    wsOut.Range("A:C").ClearContents
    
    ' 見出し行
    wsOut.Range("A1").Value = "ジャンル名チェック"
    wsOut.Range("B1").Value = "件名チェック"
    wsOut.Range("C1").Value = "本文チェック"
    
    ' ジャンル名 → A列
    If InStr(genreResult, "エラー") > 0 Then
        lines = Split(genreResult, vbCrLf)
        For i = 0 To UBound(lines)
            wsOut.Cells(i + 2, 1).Value = lines(i)
        Next i
    Else
        wsOut.Cells(2, 1).Value = "OK（エラーなし）"
    End If
    
    ' 件名 → B列
    If InStr(subjectResult, "エラー") > 0 Then
        lines = Split(subjectResult, vbCrLf)
        For i = 0 To UBound(lines)
            wsOut.Cells(i + 2, 2).Value = lines(i)
        Next i
    Else
        wsOut.Cells(2, 2).Value = "OK（エラーなし）"
    End If
    
    ' 本文 → C列
    If InStr(bodyResult, "エラー") > 0 Then
        lines = Split(bodyResult, vbCrLf)
        For i = 0 To UBound(lines)
            wsOut.Cells(i + 2, 3).Value = lines(i)
        Next i
    Else
        wsOut.Cells(2, 3).Value = "OK（エラーなし）"
    End If
    
    ' === MsgBox（簡潔表示） ===
    msg = "テンプレートジャンル名：" & IIf(InStr(genreResult, "エラー") > 0, "エラーあり", "OK") & vbCrLf & _
          "メール件名：" & IIf(InStr(subjectResult, "エラー") > 0, "エラーあり", "OK") & vbCrLf & _
          "メール本文：" & IIf(InStr(bodyResult, "エラー") > 0, "エラーあり", "OK") & vbCrLf & vbCrLf & _
          "詳細はチェック結果シートをご確認ください。"
    
    MsgBox msg, vbInformation
End Sub
