Public Sub CheckAll()
    Dim ws As Worksheet: Set ws = ActiveSheet
    Dim headerRow As Long
    Dim result As String
    Dim genreResult As String, subjectResult As String, bodyResult As String
    Dim lines() As String, i As Long
    Dim wsOut As Worksheet
    
    headerRow = GetHeaderRow(ws)
    If headerRow = -1 Then
        MsgBox "表頭に「メール本文」が見つかりません。", vbExclamation
        Exit Sub
    End If
    
    ' === 各チェック結果 ===
    genreResult = CheckTemplateGenre_Result(ws, headerRow)
    subjectResult = CheckMailSubject_Result(ws, headerRow)
    bodyResult = CheckMailBody_Result(ws, headerRow)
    
    ' === MsgBox 用まとめ ===
    result = "【総合チェック結果】" & vbCrLf & vbCrLf
    result = result & "④ テンプレートジャンル名：" & vbCrLf & genreResult & vbCrLf & vbCrLf
    result = result & "⑤ メール件名：" & vbCrLf & subjectResult & vbCrLf & vbCrLf
    result = result & "⑥ メール本文：" & vbCrLf & bodyResult
    
    ' === 出力先シート ===
    Set wsOut = Worksheets("チェック結果")
    wsOut.Range("A:C").ClearContents   ' A～C だけ初期化
    
    If InStr(result, "エラー") = 0 Then
        ' === 全てOK ===
        wsOut.Range("A1").Value = "OK（エラーなし）"
    Else
        ' === 見出し ===
        wsOut.Range("A1").Value = "ジャンル名チェック"
        wsOut.Range("B1").Value = "件名チェック"
        wsOut.Range("C1").Value = "本文チェック"
        
        ' ジャンル名 → A列に逐行出力
        lines = Split(genreResult, vbCrLf)
        For i = 0 To UBound(lines)
            wsOut.Cells(i + 2, 1).Value = lines(i)
        Next i
        
        ' 件名 → B列に逐行出力
        lines = Split(subjectResult, vbCrLf)
        For i = 0 To UBound(lines)
            wsOut.Cells(i + 2, 2).Value = lines(i)
        Next i
        
        ' 本文 → C列に逐行出力
        lines = Split(bodyResult, vbCrLf)
        For i = 0 To UBound(lines)
            wsOut.Cells(i + 2, 3).Value = lines(i)
        Next i
    End If
    
    ' === MsgBox ===
    MsgBox result, vbInformation
End Sub
