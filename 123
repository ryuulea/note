Private Function IsSjisSafe(cp As Long) As Boolean
    Dim s As String, b() As Byte
    s = ChrW(cp)
    b = StrConv(s, vbFromUnicode, 932)
    
    ' Shift-JIS → Unicode 再还原
    If StrConv(b, vbUnicode, 932) <> s Then
        IsSjisSafe = False
    ElseIf UBound(b) > 1 Then
        ' 3バイト以上はSJISに存在しない
        IsSjisSafe = False
    Else
        IsSjisSafe = True
    End If
End Function
